/**
 * Created by licp on 2016-11-28.
 */
"use strict";
var crypto = require('crypto');
var uuid = require('node-uuid');

module.exports.getUUIDInHref = function(href, reg, lastReg) {
    var serviceReg = new RegExp(reg);
    var serviceResult = serviceReg.exec(href);
    var subStr = href.substr(serviceResult['index'] + serviceResult[0].length);
    if(!lastReg){
        return subStr;
    }
    serviceReg = new RegExp(lastReg);
    serviceResult = serviceReg.exec(subStr);
    return subStr.substr(0, serviceResult['index']);
};
module.exports.getResourceUUIDInURL = function(url,name){
    var reg = new RegExp( name );
    var result = reg.exec(url);
    if( !result ) return null;
    var subStr = url.substr(result['index'] + result[0].length+1);
    result = (new RegExp('/')).exec(subStr);
    if(!result) return subStr;
    subStr = subStr.substr(0,result['index']);
    return subStr;
};


module.exports.createUUID = function(){
    var p;
    do{
        var md5 = crypto.createHash('md5');
        p = md5.update(uuid.v1()).digest('base64');
    }while( p.indexOf('/') != -1 || p.indexOf('+') != -1);
    return p.substr(0, p.length-2);
};