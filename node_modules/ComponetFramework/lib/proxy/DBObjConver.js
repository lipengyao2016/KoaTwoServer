/**
 * Created by Administrator on 2016/12/12.
 */

const utils = require('commonutils').utils;
const _ = require('lodash');



class DBObjConver {
    constructor() {

    };



    convert2DBInfo(info, isCreate = false,bHasModifiedAt = true) {
        let dateTime = utils.convertDateTime(new Date());
        let dbInfo = _.clone(info);


        if(bHasModifiedAt )
        {
            dbInfo.modifiedAt = utils.ifReturnStr(dateTime);
        }

        if (isCreate) {
            dbInfo.createdAt = dateTime;

            let uuid = utils.createUUID();
            dbInfo.uuid = utils.ifReturnStr(info.uuid, uuid);
        }
        else {

            if(bHasModifiedAt)
            {
                dbInfo.modifiedAt = utils.ifReturnStr(dateTime);
            }
            utils.removeNullProperties(dbInfo);

        }
        return dbInfo;
    }

    convert2LogicInfo(dbInfo,bHasModifiedAt = true,dateKeys = []) {
       /* dbInfo.createdAt = utils.convertDateTime(dbInfo.createdAt);


        dateKeys.map(dateKey=>{
           dbInfo[dateKey] =  utils.convertDateTime(dbInfo[dateKey]);
        });

        //if(bHasModifiedAt)
        {
            dbInfo.modifiedAt = utils.convertDateTime(dbInfo.modifiedAt);
        }
*/
       
        delete dbInfo.id;

        _.keysIn(dbInfo).map(key=>{

            let value = dbInfo[key];
            if(value instanceof  Date)
            {
                dbInfo[key] = utils.convertDateTime(value);
            }
        });
       

        return dbInfo;
    }


}



module.exports = DBObjConver;